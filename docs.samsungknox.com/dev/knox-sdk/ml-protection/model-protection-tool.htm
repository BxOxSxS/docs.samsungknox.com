<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="8" MadCap:lastHeight="1916" MadCap:lastWidth="755" MadCap:conditions="Builds.knox-sdk-build,Builds.ai-build" MadCap:conditionTagExpression="include[Builds.ai-build or Builds.common-build or Builds.knox-sdk-build] exclude[Builds.do-not-build or Builds.efota-build or Builds.india-id-build or Builds.kdp-build or Builds.kg-build or Builds.kme-build or Builds.knox-attestation-build or Builds.knox-cloud-auth-build or Builds.knox-configure or Builds.knox-validated-build or Builds.managed-config-build or Builds.tizen-build] ">
    <head>
    </head>
    <body>
        <MadCap:snippetBlock src="../../Resources/snippets/product/knox-sdk.flsnp" />
        <h1>Knox ML Encryption Tool</h1>
        <h2>Installation</h2>
        <ol>
            <li>Log in to <a href="https://partner.samsungknox.com/dashboard/download">Knox Partner Portal &gt;&#160;Dashboard &gt;&#160;Download</a>.</li>
            <li>Download one of the following:<ul><li><b>Knox ML&#160;encryption tool - Linux</b><br /><i>Supported OS version—</i> Ubuntu 20.04 <br /></li><li><b>Knox ML&#160;encryption tool - Windows</b><br /> <i>Supported OS version—</i> Windows 10</li></ul></li>
            <li>Run the executable. On Linux, follow below steps to run the Knox ML Encryption Tool:
              <ol>
                <li>Unzip  <code>KnoxMLEncryptionToolLinuxV1.2.zip</code>.
                </li>
                <li>Change the permission and run the setup.
                  <pre class="prettyprint" xml:space="preserve">
                    <p>
> chmod 777 setup.sh
> sudo ./setup.sh
                    </p>
                  </pre>
                </li>
                <li>Run the Tool from Desktop icon.
                </li>
              </ol>
            </li>
        </ol>
        <h2 id="ui">UI parameters</h2>
        <p>To generate the encrypted neural model package, following inputs from the user are required:</p>
        <table>
            <col />
            <col />
            <col />
            <col />
            <thead>
                <tr>
                    <th>Input field</th>
                    <th>Required</th>
                    <th>Explanation</th>
                    <th>Supported Format</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>ML file format</td>
                    <td>Yes</td>
                    <td>List of Model formats to choose from. The user need to select format of the Raw model which will be encrypted. Currently supported model formats are tflite, tensorflow, caffe, keras, coreML, and pytorch.</td>
                    <td>
                        <ul>
                          <li>Tensorflow (*.pb)</li>
                          <li>Tensorflow Lite (*.tflite)</li>
                          <li>Caffe (*.caffemodel)</li>
                            <li>Keras (*.pb)</li>
                            <li>coreML (*.mlmodel)</li>
                            <li>pytorch (*.pth)</li>
                            <li>ONNX (*.onnx)</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td>ONNX conversion</td>
                    <td>Yes</td>
                    <td>Select whether you want to convert to ONNX format.<br/>
<i>* CoreML,Keras,Pytorch format is required to conver to ONNX format as mandatory</i>
</td>
                    <td></td>
                </tr>
                <tr>
                    <td>Package Version</td>
                    <td>Yes</td>
                    <td>An integer value that is the version of the encrypted model package.</td>
                    <td style="vertical-align: super;">An integer in the range 1 - 4294967296</td>
                </tr>
                <tr>
                    <td>Allowed Apps List and Certificate Hash</td>
                    <td>Yes</td>
                    <td>List of allowed packages that can load the model along with Hash of the signing certificate used to sign the Apk which will be allowed to load and execute the model. </td>
                    <td>
                        <ul>
                            <li>Text (*.txt)</li>
                            <li>CSV (*.csv)</li>
                        </ul>
                    </td>
                </tr>
            </tbody>
        </table>
        <h2 id="supported-software-packages">Supported software packages</h2>
        <p>Following are the software packages and its versions supported by Knox ML Encryption 1.2 tool.</p>
        <table>
            <thead>
                <tr>
                    <th>
                        Software Packages
                    </t>
                    <th>
                        Libraries
                    </th>
                    <td>
                        Supported Version
                    </th>
                </tr>
              </thead>
              <tbody>
                <tr>
                    <td rowspan="2">
                        Keras
                    </td>
                    <td>
                        keras
                    </td>
                    <td>
                        2.4.3
                    </td>
                </tr>
                <tr style="border-bottom: 1px solid;">
                    <td>
                        keras2onnx
                    </td>
                    <td>
                        1.7.0
                    </td>
                </tr>
                <tr>
                    <td rowspan="2">
                        Onnx
                        &nbsp;
                    </td>
                    <td>
                        onnx
                    </td>
                    <td>
                        1.9.0
                    </td>
                </tr>
                <tr style="border-bottom: 1px solid;">
                    <td>
                        onnxmltools
                    </td>
                    <td>
                        1.7.0
                    </td>
                </tr>
                <tr>
                    <td rowspan="4">
                        Scikit
                        &nbsp;
                        &nbsp;
                        &nbsp;
                    </td>
                    <td>
                        scikit-learn(linux)
                    </td>
                    <td>
                        1.0
                    </td>
                </tr>
                <tr>
                    <td>
                        scikit-learn(windows)
                    </td>
                    <td>
                        0.24.2
                    </td>
                </tr>
                <tr>
                    <td>
                        skl2onnx(linux)
                    </td>
                    <td>
                        1.9.3
                    </td>
                </tr>
                <tr style="border-bottom: 1px solid;">
                    <td>
                        skl2onnx(windows)
                    </td>
                    <td>
                        1.9.3
                    </td>
                </tr>
                <tr>
                    <td rowspan="2">
                        TensorFlow
                        &nbsp;
                    </td>
                    <td>
                        tensorflow
                    </td>
                    <td>
                        2.3.0
                    </td>
                </tr>
                <tr style="border-bottom: 1px solid;">
                    <td>
                        tf2onnx
                    </td>
                    <td>
                        1.9.1
                    </td>
                </tr>
                <tr style="border-bottom: 1px solid;">
                    <td>
                        Tflite
                    </td>
                    <td>
                        tflite
                    </td>
                    <td>
                        2.4.0
                    </td>
                </tr>
                <tr style="border-bottom: 1px solid;">
                    <td>
                        Pytorch
                    </td>
                    <td>
                        torch
                    </td>
                    <td>
                        1.9.0
                    </td>
                </tr>
            </tbody>
        </table>
        <h2>Encrypt files</h2>
        <p>To encrypt your ML model, open the Knox ML Encryption Tool on your computer and do as follows depending on the tool's version. To see which version you can use depending on device, refer to <a href="tool-revision.htm">Knox ML Encryption Tool Revision</a> page.</p>
        <h3>Model Encryption Tool V1.1 steps</h3>
        <ol>
            <li>Click <b>Get Started</b>.</li>
            <li>(Optional) click <b>Settings</b> icon and select the path where you want to save the encrypted model.</li>
            <li>Click <b>Utility</b> option next to Settings icon. Browse and select the certificate file used to sign the Apk and click <b>Generate Hash</b>.</li>
            <li>Click <b>Copy Hash</b> and add it to the Allowed Apps List along side of the package name for the App.</li>
            <li>Return to <b>Encrypt Screen</b> and dd plain ML Model file and its package version.</li>
            <li>Enter Model Package version and add Allowed_Apps List under "Set Model Policy" section. Refer to Template option for proper format.</li>
            <li>Click <b>Encrypt</b>. *.KMLPKG file is created.</li>
            <li>Click <b>View File</b> button to view the encrypted package file.</li>
        </ol>
        <h3>Model Encryption Tool V1.2 steps</h3>
        <p><b>Tool Configurations:</b></p>

        <p>Before encryption, you need to do some configurations. In the image, Action 1 shows the <b>Settings tab</b>, Action 2 shows the <b>Utility tab</b>, and Action 3 shows the <b>Resource Manager tab</b>.
        <img src="../../../assets/merge/images/knox-sdk/ml/ml-tool-actions.png" /></p>

        <p><b>Settings Tab:</b></p>

        <p>In the Settings tab, you can choose the location to save the encrypted models. If you do not select any location, the encrypted model is saved at the same location as the raw model. Action 4 in in the image shows the <b>Change</b> button to click first and Action 5 shows the <b>Select folder</b> button after browsing to the desired location. Action 6 shows the selected location under <b>Location</b>.</p>

        <p><img src="../../../assets/merge/images/knox-sdk/ml/ml-tool-settings.png" /></p>

        <p> <img src="../../../assets/merge/images/knox-sdk/ml/ml-tool-settings-2.png" /></p>

        <p><b>Utility Tab:</b></p>

        <p>In the Utility tab you can choose the certificate used to sign the Apk and generate hash which is used during packaging after model encryption. Action 7 in the image shows the <b>Browse</b> button to choose this certificate file. After choosing the certificate, its path is visible under Location shown by Action 8. Action 9 shows the <b>Generate Hash</b> button. After hash generation, hash code is visible in <b>Generated Hash</b> box. Click <b>Copy</b> to copy Hash and add it to the Allowed Apps List along side of the package name for the App.</p>

        <p></p>

        <p><img src="../../../assets/merge/images/knox-sdk/ml/ml-tool-utility.png" /></p>

        <p> <img src="../../../assets/merge/images/knox-sdk/ml/ml-tool-utility-2.png" /></p>

        <p><b>Resource Manager Tab:</b></p>

        <p> In the Resource Manager tab you can download resources required for conversion of models to ONNX. This is a one-time process and once downloaded, the resources will remain downloaded. Alternatively, resources can be downloaded during encryption, as and when required.</p>

        <p></p>

        <p><img src="../../../assets/merge/images/knox-sdk/ml/ml-tool-resource-manager.png" /></p>

        <p></p>

        <ol>
            <li>Click <b>Get Started</b> button as shown in Action 1 in the image. Action 2 shows the <b>Encrypt file</b> highlighted with blue underline, Action 3 shows the <b>ML File format</b> button, and Action 4 displays the disabled <b>Add</b> button.
              <p><img src="../../../assets/merge/images/knox-sdk/ml/ml-tool-encryption-1.png" /></p>
            </li>
            <li>Select <b>Model type</b> from drop down list as demonstrated by Action 7 and download the resources required to convert ML model to ONNX model type as demonstrated by Action 8.
              <p><img src="../../../assets/merge/images/knox-sdk/ml/ml-tool-encryption-2.png" /></p>
            </li>
            <li>Click the <b>Add</b> button as demonstrated in Action 4. This opens up the file browser. Select the appropriate file as indicated in Action 9 and after the selection, click <b>Open</b> as indicated in Action 10. The name of the selected file is visible in the <b>ML File</b> field as shown in Action 11.
              <p><img src="../../../assets/merge/images/knox-sdk/ml/ml-tool-encryption-3.png" /></p>
            </li>
            <li>Add the package name as demonstrated in Action 12. To select <b>Allowed Apps List</b> click the <b>Add</b> button as in Action 13. A file browser pops up. Select the appropriate list and click <b>Open</b> as demonstrated in the Action 14 and 15.
              <p><img src="../../../assets/merge/images/knox-sdk/ml/ml-tool-encryption-4.png" /></p>
            </li>
              <p><img src="../../../assets/merge/images/knox-sdk/ml/ml-tool-encryption-5.png" /></p>
              <li>The allowed apps list file name is visible in the <b>Allowed Apps</b> field as demonstrated in Action 16. If ONNX conversion option is selected, Click the <b>Next</b> button and provide input parameters required for ONNX conversion, otherwise click the <b>Encrypt</b> button as demonstrated in Action 17, and encryption process starts as demonstrated in Action 18.
            </li>
            <li>As the encryption is completed you are redirected to the <b>Encryption Successful!</b>. Your encrypted model package is generated in the folder specified. Clicking on <b>View file</b> as shown in Action 19 takes you to the generated package.
              <p><img src="../../../assets/merge/images/knox-sdk/ml/ml-tool-encryption-6.png" /></p>
            </li>
        </ol>
        <h2>Types of Encrypted Knox ML output packages</h2>
        <p>You can generate following two types of Knox ML packages:</p>
        <ul>
            <li><b>KONPKG</b>—This ONNX converted-ML model package format is supported by Knox ML Encryption Tool v1.2 onwards. This format is currently supported in devices with SDK 3.8 with KnoxML version v1.2 or higher</li>
            <li><b>KMLPKG</b>—This ML model package format is supported by Knox ML Encryption Tool v1.1 onwards. This format is currently supported in devices with SDK 3.7.1  with KnoxML version v1.1 or higher.</li>
        </ul>
        <div class="callout note"><b>NOTE</b>—To find out what Knox version your device is on, go to <b>Settings</b> &gt; <b>About phone</b> &gt; <b>Software information</b> &gt;&#160;<b>Knox version</b>.</div>
        <h2>Deploy encrypted package to app</h2>
        <p>You can deploy the generated model package by keeping it in the application assets folder. Knox SDK provides the APIs to load the model in the application run-time.</p>
        <p>To load the Model package in the application run-time, make a File Descriptor (FD) or create a data buffer of the package —if the package is present in the assets of the application— and call the subsequent API. To learn more about the development process, see <a href="model-protection-deployment.htm">model protection deployment</a>, but ensure that you have the <a href="model-protection-developer.htm">Knox SDK installed</a> before you do so.</p>
        <h2 id="troubleshooting">Troubleshooting</h2>
        <p>If you run into any errors, a failure log is generated. You can create a support ticket through your <a href="https://partner.samsungknox.com/dashboard/support" target="_blank">Knox Partner Portal &gt; Support</a>. Attach the failure log with the ticket and describe the issue in detail so that we can reproduce it to fix the error.</p>
        <p>
            <img src="../../../assets/merge/images/knox-sdk/ml/tool-error.png" />
        </p>
    </body>
</html>
