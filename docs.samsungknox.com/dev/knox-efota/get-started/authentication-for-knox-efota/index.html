<!DOCTYPE html>
<html lang="en">





  






  
  
<head>
  <meta charset="utf-8">
  
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-CV8C3DHP6P"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-CV8C3DHP6P');
  </script>
  
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-54474000-1', 'auto'); 
    ga('send', 'pageview');
  </script>
  
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-P24TWCG');</script><meta name="viewport" content="width=device-width,height=device-height,initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Authentication for Knox E-FOTA  | Knox E-FOTA  | Samsung Knox Documentation</title>
  <meta http-equiv="content-language" content="en">
  <meta name="language" content="en">
  <script src="../../../assets/js/bundle.js"></script>
  <link rel="stylesheet" href="../../../styles/main.min.css">
  <link rel="icon" href="../../../favicon.ico" type="image/x-icon">
  <link rel="icon" sizes="16x16" href="../../../favicon-16x16.png" type="image/png">
  <link rel="icon" sizes="32x32" href="../../../favicon-32x32.png" type="image/png">
  <link rel="manifest" href="../../../manifest.json">
  <link rel="apple-touch-icon" sizes="180x180" href="../../../apple-touch-icon.png">
  <link rel="mask-icon" href="../../../safari-pinned-tab.svg" color="#5bbad5">
  <meta name="theme-color" content="white">
</head>
<body id=ZgotmplZ>
  
    

  

<script onload="initBot()" defer src="https://dc-chbt.samsungknox.com/copilot/index.js?noCache=1759433021"></script>
<script defer>
    function initBot(){
      const relPath = "\/knox-efota\/get-started\/authentication-for-knox-efota\/";
      const prePath = relPath  === '/' ? "." : window.location.href.split(relPath)[0];
      window.chatbot.init("https:\/\/dc-chbt.samsungknox.com", prePath + "/assets/styles/chatbot.css");
    }
</script>
  
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-P24TWCG" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  
    <header>
  <div class="container-xxl border-bottom">
    <nav class="nav-top navbar navbar-expand-lg d-flex px-3">
        <a class="navbar-brand" href="../../../index.html">
          <img src="../../../svg/samsung_knox_doc_logo.svg" alt="Logo for Samsung Knox documentation">
        </a>
        <div class="collapse navbar-collapse">
          <ul class="row align-items-center ms-10 mb-0 p-0">
            
            
            <li class="navbar-nav col">
              <a href="../../../../admin/index.html" class="body-4 text-black fw-light pe-auto me-6 text-decoration-none ">Admin</a>
            </li>
            
            <li class="navbar-nav col">
              <a href="../../../index.html" class="body-4 text-black fw-light pe-auto me-6 text-decoration-none fw-bold border-bottom border-2 border-black">Developer</a>
            </li>
            
            <li class="navbar-nav col">
              <a href="../../../../partner/index.html" class="body-4 text-black fw-light pe-auto me-3 text-decoration-none ">Partner</a>
            </li>
            
          </ul>
        </div>
        <div class="ms-auto">
          <div class="collapse navbar-collapse">
            <div class="head-search-wrapper ms-auto ">
              <script async src="https://cse.google.com/cse.js?cx=9119a64f9020430ac"></script>
<div class="gcse-search"></div>

            </div>
          </div>
        </div>
    </nav>
  </div>
</header>

  
  <main>
    
      <div class="container-xxl l-layout">
        <div class="l-sidebar pt-md-6">
          
<aside class="ps-2 pe-4">
  <div class="d-inline-block w-100 position-relative">
  <button id="guide-navigation-button" type="button" data-bs-toggle="collapse" data-bs-target="#guide-navigation" aria-controls="#guide-navigation" aria-expanded="false" class="dropdown-button border border-2">Samsung Knox developer guides</button>
  <div id="guide-navigation" class="collapse w-100 position-absolute dropdown">
    <nav aria-labelledby="guide-navigation-button" class="dropdown-content">
      <ul>
      <li>
  <a href="../../../fundamentals" >Fundamentals</a>
  </li>
<li>
  <span>Device apps</span>
  <ul>
    <li>
  <a href="../../../knox-sdk" >Knox SDK</a>
  <ul>
    </ul>
  </li>
<li>
  <a href="../../../knox-pos-sdk" >Knox POS SDK</a>
  </li>
<li>
  <a href="../../../knox-capture-sdk" >Knox Capture SDK</a>
  </li>
<li>
  <a href="../../../knox-tizen-sdk" >Knox Tizen SDK</a>
  </li>
</ul>
  </li>
<li>
  <span>Web services</span>
  <ul>
    <li>
  <a href="../../../knox-cloud-authentication" >Knox cloud services authentication</a>
  <ul>
    </ul>
  </li>
<li>
  <a href="../../../knox-webhook-notification" >Knox Webhook Notification</a>
  <ul>
    </ul>
  </li>
<li>
  <a href="../../../knox-deployment-program" >Knox Deployment Program</a>
  </li>
<li>
  <a href="../../../knox-msp-portal" >Knox MSP Portal</a>
  </li>
<li>
  <a href="../../../knox-mobile-enrollment" >Knox Mobile Enrollment</a>
  </li>
<li>
  <a href="../../../knox-efota" class="active-drop-item">Knox E-FOTA</a>
  </li>
<li>
  <a href="../../../knox-configure" >Knox Configure</a>
  </li>
<li>
  <a href="../../../knox-manage" >Knox Manage</a>
  </li>
<li>
  <a href="../../../knox-attestation" >Knox Attestation</a>
  </li>
<li>
  <a href="../../../knox-guard" >Knox Guard</a>
  </li>
<li>
  <a href="../../../knox-asset-intelligence" >Knox Asset Intelligence</a>
  </li>
</ul>
  </li>
<li>
  <a href="../../../managed-configurations" >Managed configurations</a>
  </li>
</ul>
    </nav>
  </div>
</div><h3 class="body-3 mt-4 ps-2">Knox E-FOTA</h3>
  <nav class="side-nav">
    <ul class="ps-2">
      
      
      <li>
        <div>
          <a class="body-5 text-black fw-light" href="../../../knox-efota.html">Introduction</a>
        </div>
      </li>
        
          
  
  
    <li class="mt-2">
    
    <div class="d-flex justify-content-between cursor-pointer" data-bs-toggle="collapse" data-bs-target="#sub-knox-efota-get-started-get-started" aria-expanded="false">
      <span class="body-5 text-black fw-light">Get started</span>
      <a class="btn-toggle d-inline-flex rounded border-0 fw-light" data-bs-toggle="collapse" data-bs-target="#sub-knox-efota-get-started-get-started" aria-expanded="true"></a>
    </div>
      
    <div class="show" id="sub-knox-efota-get-started-get-started">
      <ul>
      
      
  
  
    <li class="mt-2">
    
    
    <div class="d-flex justify-content-between">
      <a class="body-5 text-black fw-light" href="../overview/index.html">Overview</a>
    </div>
    
    </li>
  
  
  
    <li class="mt-2">
    
    
    <div class="d-flex justify-content-between">
      <a class="body-5 text-black active" href="index.html">Authentication for Knox E-FOTA</a>
    </div>
    
    </li>
  
  
  
    <li class="mt-2">
    
    <div class="d-flex justify-content-between cursor-pointer" data-bs-toggle="collapse" data-bs-target="#sub-knox-efota-get-started-best-practices-best-practices" aria-expanded="false">
      <span class="body-5 text-black fw-light">Knox E-FOTA best practices</span>
      <a class="btn-toggle d-inline-flex rounded border-0 fw-light" data-bs-toggle="collapse" data-bs-target="#sub-knox-efota-get-started-best-practices-best-practices" aria-expanded="false"></a>
    </div>
      
    <div class="collapse" id="sub-knox-efota-get-started-best-practices-best-practices">
      <ul>
      
      
  
  
    <li class="mt-2">
    
    
    <div class="d-flex justify-content-between">
      <a class="body-5 text-black fw-light" href="../best-practices/knox-efota-workflow/index.html">Knox E-FOTA workflow</a>
    </div>
    
    </li>
  
  
  
    <li class="mt-2">
    
    
    <div class="d-flex justify-content-between">
      <a class="body-5 text-black fw-light" href="../best-practices/licenses-and-devices/index.html">Licenses and devices</a>
    </div>
    
    </li>
  
  
  
    <li class="mt-2">
    
    
    <div class="d-flex justify-content-between">
      <a class="body-5 text-black fw-light" href="../best-practices/campaigns-and-firmware/index.html">Campaigns and firmware</a>
    </div>
    
    </li>
  
  
  
    <li class="mt-2">
    
    
    <div class="d-flex justify-content-between">
      <a class="body-5 text-black fw-light" href="../best-practices/monitoring-and-troubleshooting/index.html">Monitoring and troubleshooting</a>
    </div>
    
    </li>
  </ul>
    </div></li>
  </ul>
    </div></li>
  
        
          
  
  
    <li class="mt-2">
    
    
    <div class="d-flex justify-content-between">
      <a class="body-5 text-black fw-light" href="../../api/index.html">API reference</a>
    </div>
    
    </li>
  
        
          
  
  
    <li class="mt-2">
    
    
    <div class="d-flex justify-content-between">
      <a class="body-5 text-black fw-light" href="../../error-codes/index.html">Error codes</a>
    </div>
    
    </li>
  
        
          
  
  
    <li class="mt-2">
    
    <div class="d-flex justify-content-between">
      <a class="body-5 text-black fw-light" href="../../release-notes/index.html">Release notes</a>
    </div>
      
    </li>
  </ul>
  </nav>
</aside></div>
        <div class="l-main pt-md-6">
          
          <div class="l-content-top mb-4">
            <div class="l-breadcrumb">
              <a class="fw-light text-black" href="../../../index.html">Home</a><span> /</span>
<a class="fw-light text-black" href="../../../knox-efota.html">Knox E-FOTA</a><span> /</span>
<a class="fw-light text-black" href="../index.html">Get started</a><span> /</span>

            </div>
            <div class="mt-4">
              <h1>Authentication for Knox E-FOTA</h1>
            </div>
            

  <p><span>Last updated March  18th, 2025</span></p>


    

</div>
          <div class="l-content">
            

  




      
      
      
      
        
      
      
      
      
        
      
      
      
      
        
      
      
      
      
        
      
      
      
      
        
      
      
      
      
        
      
      
      
      
        
      
      
      
      
        
      
      
      
      
        
      
      
      
      
        
      
      
      
      
        
      
      
      
      
        
      
      
      
      
        
      
      
      
      
        
      
      
      
      
        <p>Before you can access the Knox E-FOTA API, you must set up <a href="../../../knox-cloud-authentication/knox-oauth-2-0-authentication">Knox OAuth 2.0 Authentication</a>. This guide will cover how to set up authentication for secure access to the Knox E-FOTA API.</p>
<div class="notice-note"><p>UAT test accounts require a different security certificate. To use UAT test accounts, please contact Samsung support.</p></div>
<h2 id="register-an-app">Register an app</h2>
<p>The first step of Knox OAuth 2.0 Authentication is to register your application. See the full steps on how to <a href="../../../knox-cloud-authentication/knox-oauth-2-0-authentication/register-new-app">Register new app</a>.</p>
<p>OAuth 2.0 scopes are used to specify the level of access your application has to your customer&rsquo;s Knox E-FOTA resources. When you register your application, make sure you add the required scopes so your application can access various features of Knox E-FOTA.</p>
<p>You can request more granular access permissions by only adding scopes for specific Knox E-FOTA operations. If multiple scopes are requested, the user must consent to all of them and may not select individual scopes. For a superior customer experience, please ensure that your application requests the least number of scope permissions.</p>
<p>Here is a list of scopes you can add for Knox E-FOTA:</p>
<div class="overflow-auto my-3"><table>
<thead>
<tr>
<th>Scope</th>
<th>Permission</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ke</code></td>
<td>Manage all Knox E-FOTA functionality.</td>
</tr>
<tr>
<td><code>ke.campaign</code></td>
<td>View, assign, create, delete, and cancel Knox E-FOTA campaigns.</td>
</tr>
<tr>
<td><code>ke.campaign:view</code></td>
<td>View Knox E-FOTA campaign information.</td>
</tr>
<tr>
<td><code>ke.campaign:assign</code></td>
<td>Assign or unassign devices from a Knox E-FOTA campaign.</td>
</tr>
<tr>
<td><code>ke.campaign:manage</code></td>
<td>Create and edit Knox E-FOTA campaigns.</td>
</tr>
<tr>
<td><code>ke.campaign:delete</code></td>
<td>Delete and cancel Knox E-FOTA campaigns.</td>
</tr>
<tr>
<td><code>ke.devices</code></td>
<td>View, upload, manage, and delete Knox E-FOTA devices.</td>
</tr>
<tr>
<td><code>ke.devices:view</code></td>
<td>View Knox E-FOTA device information.</td>
</tr>
<tr>
<td><code>ke.devices:manage</code></td>
<td>Upload, refresh, and unenroll Knox E-FOTA devices.</td>
</tr>
<tr>
<td><code>ke.devices:delete</code></td>
<td>Delete devices from Knox E-FOTA.</td>
</tr>
<tr>
<td><code>ke.licenses</code></td>
<td>View, register, and delete Knox E-FOTA licenses.</td>
</tr>
<tr>
<td><code>ke.licenses:view</code></td>
<td>View Knox E-FOTA license information.</td>
</tr>
<tr>
<td><code>ke.licenses:manage</code></td>
<td>Register commercial licenses and generate trial licenses for Knox E-FOTA.</td>
</tr>
<tr>
<td><code>ke.licenses:delete</code></td>
<td>Delete Knox E-FOTA licenses.</td>
</tr>
<tr>
<td><code>ke.fota:view</code></td>
<td>View Knox E-FOTA firmware information.</td>
</tr>
<tr>
<td><code>ke.privacyPolicy</code></td>
<td>View and manage the skip privacy policy setting.</td>
</tr>
<tr>
<td><code>ke.privacyPolicy:view</code></td>
<td>View the skip privacy policy setting.</td>
</tr>
<tr>
<td><code>ke.privacyPolicy:manage</code></td>
<td>Manage the skip privacy policy setting.</td>
</tr>
</tbody>
</table></div>
<div class="notice-note"><p>When adding the redirect URL, Samsung servers will only communicate with URLs that you have identified as trusted.</p><ul><li>URLs must be absolute:<ul><li>Use <code>https://dev.example.com/oauth2/EMM/redirect</code>, not <code>/oauth2/EMM/redirect</code>.</li></ul></li><li>Parameters are ignored:<ul><li><code>https://dev.example.com/oauth2/EMM/redirect?id=1</code> will become <code>https://dev.example.com/oauth2/EMM/redirect</code>.</li></ul></li><li>URLs cannot include ‘#’ or ‘*’:<ul><li><code>https://dev.example.com/oauth2/EMM/redirect#example</code> is invalid.</li></ul></li></ul></div>
<h2 id="3-legged-knox-oauth-20-authentication">3-legged Knox OAuth 2.0 Authentication</h2>
<p>After you&rsquo;ve registered your app, you can begin the 3-legged authentication process to access your customer&rsquo;s Knox E-FOTA resources on their behalf.</p>
<h3 id="step-1-request-an-authorization-code">Step 1: Request an authorization code</h3>
<p>To request an authorization code, you must direct the client&rsquo;s browser to Samsung&rsquo;s authorization page, where your customer either accepts or denies your application&rsquo;s permission request to access their Knox E-FOTA resources. See how to get an <a href="../../../knox-cloud-authentication/knox-oauth-2-0-authentication/for-uem-partners/step-1-get-authorization-code">Authorization code</a>.</p>
<p>Here is a Java code sample to get an authorization code:</p>

<div class="accordion  mt-6 mb-4">
  <div>







<div id="request-authorization-code-sample" class="accordion-item">
  <h4 class="body-3  mt-0 " id="panelsStayOpen-heading2-0">
    <button
        class="accordion-button accordion-header fw-bold text-grey  collapsed "
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#panelsStayOpen-collapse2-0"
        aria-expanded="false"
        aria-controls="panelsStayOpen-collapse2-0"
    >
      <div>Code sample
      </div>
    </button>
  </h4>
  <div
      id="panelsStayOpen-collapse2-0"
      class="accordion-collapse collapse "
      aria-labelledby="panelsStayOpen-heading2-0"
    >
      <div class="accordion-body text-grey"><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">private</span> <span style="color:#b00040">void</span> <span style="color:#00f">getAuthorizationCode</span><span style="color:#666">(</span>HttpServletResponse response<span style="color:#666">)</span> <span style="color:#008000;font-weight:bold">throws</span> IOException <span style="color:#666">{</span>
</span></span><span style="display:flex;"><span>    String redirectUri <span style="color:#666">=</span> selfUri <span style="color:#666">+</span> <span style="color:#ba2121">&#34;redirect&#34;</span><span style="color:#666">;</span>
</span></span><span style="display:flex;"><span>    String scope <span style="color:#666">=</span> <span style="color:#ba2121">&#34;ke&#34;</span><span style="color:#666">;</span>
</span></span><span style="display:flex;"><span>    String url <span style="color:#666">=</span> authUri <span style="color:#666">+</span> <span style="color:#ba2121">&#34;oauth2/authorize?&#34;</span> <span style="color:#666">+</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ba2121">&#34;response_type=code&#34;</span> <span style="color:#666">+</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ba2121">&#34;&amp;client_id=&#34;</span> <span style="color:#666">+</span> clientId <span style="color:#666">+</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ba2121">&#34;&amp;scope=&#34;</span> <span style="color:#666">+</span> scope <span style="color:#666">+</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ba2121">&#34;&amp;redirect_uri=&#34;</span> <span style="color:#666">+</span> redirectUri <span style="color:#666">+</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ba2121">&#34;&amp;code_challenge=&#34;</span> <span style="color:#666">+</span> codeChallenge <span style="color:#666">+</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ba2121">&#34;&amp;code_challenge_method=S256&#34;</span> <span style="color:#666">+</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ba2121">&#34;&amp;state=&#34;</span> <span style="color:#666">+</span> state<span style="color:#666">;</span>
</span></span><span style="display:flex;"><span>    response<span style="color:#666">.</span><span style="color:#7d9029">sendRedirect</span><span style="color:#666">(</span>url<span style="color:#666">);</span>
</span></span><span style="display:flex;"><span><span style="color:#666">}</span>
</span></span></code></pre></div></div>
    </div>
</div>
</div>
</div>

<p>For more information, see the <a href="../../../knox-cloud-authentication/knox-oauth-2-0-authentication/knox-oauth-2-0-authentication-api#tag/Authorization-server/operation/getAuthorize">Knox OAuth 2.0 Authentication API reference</a>.</p>
<p>Once you request an authorization code, the following occurs:</p>
<ol>
<li>
<p>If this is a first-time request, the permission request timed out, or if permission was manually revoked by your customer, their browser is redirected to Samsung&rsquo;s authorization consent page. If your customer has already granted permission previously, this authorization page is bypassed and your customer is immediately redirected to the URL provided in the <code>redirect_uri</code> query parameter.</p>
</li>
<li>
<p>Once redirected, your customer is prompted to log in to their Samsung Account or through an IdP.</p>
</li>
<li>
<p>When your customer logs in, they are shown an access request page which identifies your application and outlines the particular permissions and scopes that your application is requesting. Here, they can choose which permissions to grant, and click <strong>Allow</strong> to approve your application&rsquo;s request to access their Knox E-FOTA resources on their behalf.</p>

    
    
    
    
    
    
      
      
      
      
      
        
        
        
        
          
        
        
      
        
        
        
        
          
        
        
      
        
        
        
        
          
        
        
      
        
        
        
        
          
        
        
      
        
        
        
        
          
        
        
      
        
        
        
        
          
        
        
      
        
        
        
        
          
        
        
      
        
        
        
          
        
        
        
      
        
        
        
          
        
        
        
      
        
        
        
          
        
        
        
      
        
        
        
          
        
        
        
      
        
        
        
          
        
        
        
      
        
        
        
          
        
        
        
      
    
    
    <p><img src="../../assets/access-requested-blocked.png" class="image-block-scale-50 img-thumbnail" alt="Access request page for end customer" /></p>
</li>
<li>
<p>When your customer completes the authorization process, their browser is redirected to the URL provided in the <code>redirect_uri</code> query parameter. When this happens, your app is given an authorization code, which is used to exchange for an access token. To protect customer data, authorization codes have a short expiration time. You can configure the authorization code expiration time between 1 and 5 minutes when you <a href="../../../knox-cloud-authentication/knox-oauth-2-0-authentication/register-new-app">register your app</a>.</p>
</li>
</ol>
<div class="notice-note"><ul><li><p>This approval process ensures that Samsung customers are aware of what level of granularity an application may access or action it may perform on their behalf. For example, <code>ke</code> scope will grant access to all Knox E-FOTA related actions and resources, while <code>ke.campaign</code> will only grant access to campaign related actions and resources.</p></li><li><p>If the scope permissions change in your app, your customers must re-authenticate to ensure that they have explicitly granted your application all of the permissions that it is requesting on their behalf.</p></li><li><p>If Knox E-FOTA is connected to your UEM console, your customer might encounter an issue where the EMM group sync feature is unavailable on their Knox E-FOTA console. On the console, the following warning is displayed:</p><blockquote><p>EMM group sync features are unavailable because your data is being managed outside Knox E-FOTA.</p></blockquote><p>If EMM group sync is unavailable, all EMM groups stop syncing, and the EMM instances are disconnected from Knox E-FOTA.</p></li></ul></div>
<h4 id="failed-requests">Failed requests</h4>
<p>If your customer chooses to cancel, or the request fails for any reason, the client is redirected to your <code>redirect_uri</code> with the corresponding error:</p>
<ul>
<li>&ldquo;response_type&rdquo; parameter of authorization request is missing or invalid.</li>
<li>&ldquo;redirect_uri&rdquo; parameter of authorization request is invalid.</li>
<li>&ldquo;client_id&rdquo; parameter of authorization request is missing or invalid.</li>
</ul>
<p>For more information, refer to the <a href="../../../knox-cloud-authentication/knox-oauth-2-0-authentication/knox-oauth-2-0-authentication-api#tag/Authorization-server/operation/getAuthorize">Authorization server API reference</a>.</p>
<h3 id="step-2-exchange-authorization-code-for-an-access-token">Step 2: Exchange authorization code for an access token</h3>
<p>The next step is to get an access token for your application using the authorization code from the previous step. See how to <a href="../../../knox-cloud-authentication/knox-oauth-2-0-authentication/for-uem-partners/step-2-get-access-and-refresh-tokens">Get access and refresh tokens</a>.</p>
<p>To protect customer data, access tokens have an expiration time. You can configure the access token expiration time between 1 and 60 minutes when you <a href="../../../knox-cloud-authentication/knox-oauth-2-0-authentication/register-new-app">register your app</a>.</p>
<p>Here is a Java code sample that requests an access token:</p>

<div class="accordion  mt-6 mb-4">
  <div>







<div id="exchange-auth-code-for-access-token-sample" class="accordion-item">
  <h4 class="body-3  mt-0 " id="panelsStayOpen-heading5-0">
    <button
        class="accordion-button accordion-header fw-bold text-grey  collapsed "
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#panelsStayOpen-collapse5-0"
        aria-expanded="false"
        aria-controls="panelsStayOpen-collapse5-0"
    >
      <div>Code sample to get an access token
      </div>
    </button>
  </h4>
  <div
      id="panelsStayOpen-collapse5-0"
      class="accordion-collapse collapse "
      aria-labelledby="panelsStayOpen-heading5-0"
    >
      <div class="accordion-body text-grey"><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">private</span> HttpResponse<span style="color:#666">&lt;</span>String<span style="color:#666">&gt;</span> <span style="color:#00f">getAccessToken</span><span style="color:#666">(</span>String code<span style="color:#666">)</span> <span style="color:#008000;font-weight:bold">throws</span> URISyntaxException<span style="color:#666">,</span> IOException<span style="color:#666">,</span> InterruptedException <span style="color:#666">{</span>
</span></span><span style="display:flex;"><span>    String redirectUri <span style="color:#666">=</span> SELF_URI <span style="color:#666">+</span> <span style="color:#ba2121">&#34;redirect&#34;</span><span style="color:#666">;</span>
</span></span><span style="display:flex;"><span>    String tokenUrl <span style="color:#666">=</span> AUTH_URI <span style="color:#666">+</span> <span style="color:#ba2121">&#34;oauth2/token&#34;</span><span style="color:#666">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Map<span style="color:#666">&lt;</span>String<span style="color:#666">,</span> String<span style="color:#666">&gt;</span> parameters <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">new</span> HashMap<span style="color:#666">&lt;&gt;();</span>
</span></span><span style="display:flex;"><span>    parameters<span style="color:#666">.</span><span style="color:#7d9029">put</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;grant_type&#34;</span><span style="color:#666">,</span> <span style="color:#ba2121">&#34;authorization_code&#34;</span><span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    parameters<span style="color:#666">.</span><span style="color:#7d9029">put</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;code&#34;</span><span style="color:#666">,</span> code<span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    parameters<span style="color:#666">.</span><span style="color:#7d9029">put</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;redirect_uri&#34;</span><span style="color:#666">,</span> redirectUri<span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    parameters<span style="color:#666">.</span><span style="color:#7d9029">put</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;client_id&#34;</span><span style="color:#666">,</span> CLIENT_ID<span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    parameters<span style="color:#666">.</span><span style="color:#7d9029">put</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;client_secret&#34;</span><span style="color:#666">,</span> CLIENT_SECRET<span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    parameters<span style="color:#666">.</span><span style="color:#7d9029">put</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;code_verifier&#34;</span><span style="color:#666">,</span> codeVerifier<span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    String body <span style="color:#666">=</span> convertToUrlEncoded<span style="color:#666">(</span>parameters<span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    HttpClient client <span style="color:#666">=</span> HttpClient<span style="color:#666">.</span><span style="color:#7d9029">newHttpClient</span><span style="color:#666">();</span>
</span></span><span style="display:flex;"><span>    HttpRequest request <span style="color:#666">=</span> HttpRequest<span style="color:#666">.</span><span style="color:#7d9029">newBuilder</span><span style="color:#666">()</span>
</span></span><span style="display:flex;"><span>            <span style="color:#666">.</span><span style="color:#7d9029">uri</span><span style="color:#666">(</span><span style="color:#008000;font-weight:bold">new</span> URI<span style="color:#666">(</span>tokenUrl<span style="color:#666">))</span>
</span></span><span style="display:flex;"><span>            <span style="color:#666">.</span><span style="color:#7d9029">headers</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;Content-Type&#34;</span><span style="color:#666">,</span> <span style="color:#ba2121">&#34;application/x-www-form-urlencoded&#34;</span><span style="color:#666">)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#666">.</span><span style="color:#7d9029">POST</span><span style="color:#666">(</span>HttpRequest<span style="color:#666">.</span><span style="color:#7d9029">BodyPublishers</span><span style="color:#666">.</span><span style="color:#7d9029">ofString</span><span style="color:#666">(</span>body<span style="color:#666">))</span>
</span></span><span style="display:flex;"><span>            <span style="color:#666">.</span><span style="color:#7d9029">build</span><span style="color:#666">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">return</span> client<span style="color:#666">.</span><span style="color:#7d9029">send</span><span style="color:#666">(</span>request<span style="color:#666">,</span> HttpResponse<span style="color:#666">.</span><span style="color:#7d9029">BodyHandlers</span><span style="color:#666">.</span><span style="color:#7d9029">ofString</span><span style="color:#666">());</span>
</span></span><span style="display:flex;"><span><span style="color:#666">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">private</span> String <span style="color:#00f">convertToUrlEncoded</span><span style="color:#666">(</span>Map<span style="color:#666">&lt;</span>String<span style="color:#666">,</span> String<span style="color:#666">&gt;</span> parameters<span style="color:#666">)</span> <span style="color:#666">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">return</span> parameters<span style="color:#666">.</span><span style="color:#7d9029">entrySet</span><span style="color:#666">()</span>
</span></span><span style="display:flex;"><span>            <span style="color:#666">.</span><span style="color:#7d9029">stream</span><span style="color:#666">()</span>
</span></span><span style="display:flex;"><span>            <span style="color:#666">.</span><span style="color:#7d9029">map</span><span style="color:#666">(</span>e <span style="color:#666">-&gt;</span> e<span style="color:#666">.</span><span style="color:#7d9029">getKey</span><span style="color:#666">()</span> <span style="color:#666">+</span> <span style="color:#ba2121">&#34;=&#34;</span> <span style="color:#666">+</span> URLEncoder<span style="color:#666">.</span><span style="color:#7d9029">encode</span><span style="color:#666">(</span>e<span style="color:#666">.</span><span style="color:#7d9029">getValue</span><span style="color:#666">(),</span> StandardCharsets<span style="color:#666">.</span><span style="color:#7d9029">UTF_8</span><span style="color:#666">))</span>
</span></span><span style="display:flex;"><span>            <span style="color:#666">.</span><span style="color:#7d9029">collect</span><span style="color:#666">(</span>Collectors<span style="color:#666">.</span><span style="color:#7d9029">joining</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;&amp;&#34;</span><span style="color:#666">));</span>
</span></span><span style="display:flex;"><span><span style="color:#666">}</span>
</span></span></code></pre></div></div>
    </div>
</div>








<div id="exchange-auth-code-for-access-token-sample" class="accordion-item">
  <h4 class="body-3  mt-0 " id="panelsStayOpen-heading5-1">
    <button
        class="accordion-button accordion-header fw-bold text-grey  collapsed "
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#panelsStayOpen-collapse5-1"
        aria-expanded="false"
        aria-controls="panelsStayOpen-collapse5-1"
    >
      <div>Code sample for redirects
      </div>
    </button>
  </h4>
  <div
      id="panelsStayOpen-collapse5-1"
      class="accordion-collapse collapse "
      aria-labelledby="panelsStayOpen-heading5-1"
    >
      <div class="accordion-body text-grey"><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">public</span> String <span style="color:#00f">redirect</span><span style="color:#666">(</span><span style="color:#a2f">@RequestParam</span> String code<span style="color:#666">,</span>
</span></span><span style="display:flex;"><span>                       <span style="color:#a2f">@RequestParam</span> String state<span style="color:#666">)</span> <span style="color:#008000;font-weight:bold">throws</span> URISyntaxException<span style="color:#666">,</span> IOException<span style="color:#666">,</span> InterruptedException <span style="color:#666">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">(!</span>Objects<span style="color:#666">.</span><span style="color:#7d9029">equals</span><span style="color:#666">(</span>state<span style="color:#666">,</span> <span style="color:#008000;font-weight:bold">this</span><span style="color:#666">.</span><span style="color:#7d9029">state</span><span style="color:#666">))</span> <span style="color:#666">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#008000;font-weight:bold">return</span> <span style="color:#ba2121">&#34;Invalid state parameter!&#34;</span><span style="color:#666">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    var response <span style="color:#666">=</span> getAccessToken<span style="color:#666">(</span>code<span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">(</span>response<span style="color:#666">.</span><span style="color:#7d9029">statusCode</span><span style="color:#666">()</span> <span style="color:#666">!=</span> <span style="color:#666">200</span><span style="color:#666">)</span> <span style="color:#666">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#008000;font-weight:bold">return</span> <span style="color:#ba2121">&#34;Something went wrong. Status code: &#34;</span> <span style="color:#666">+</span> response<span style="color:#666">.</span><span style="color:#7d9029">statusCode</span><span style="color:#666">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Instant currentTime <span style="color:#666">=</span> Instant<span style="color:#666">.</span><span style="color:#7d9029">now</span><span style="color:#666">();</span>
</span></span><span style="display:flex;"><span>    JSONObject json <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">new</span> JSONObject<span style="color:#666">(</span>response<span style="color:#666">.</span><span style="color:#7d9029">body</span><span style="color:#666">());</span>
</span></span><span style="display:flex;"><span>    accessToken <span style="color:#666">=</span> json<span style="color:#666">.</span><span style="color:#7d9029">getString</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;access_token&#34;</span><span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    refreshToken <span style="color:#666">=</span> json<span style="color:#666">.</span><span style="color:#7d9029">getString</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;refresh_token&#34;</span><span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    expiresIn <span style="color:#666">=</span> json<span style="color:#666">.</span><span style="color:#7d9029">getInt</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;expires_in&#34;</span><span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    expirationTime <span style="color:#666">=</span> currentTime<span style="color:#666">.</span><span style="color:#7d9029">plusSeconds</span><span style="color:#666">(</span>expiresIn<span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">return</span> <span style="color:#ba2121">&#34;Authorized successfully!&#34;</span><span style="color:#666">;</span>
</span></span><span style="display:flex;"><span><span style="color:#666">}</span>
</span></span></code></pre></div></div>
    </div>
</div>
</div>
</div>

<p>For more information, see the <a href="../../../knox-cloud-authentication/knox-oauth-2-0-authentication/knox-oauth-2-0-authentication-api#tag/Authorization-server/operation/postToken">Knox OAuth 2.0 Authorization API reference</a>.</p>
<h3 id="step-3-call-the-knox-e-fota-api">Step 3: Call the Knox E-FOTA API</h3>
<p>Once you&rsquo;ve obtained an access token, you can start making authenticated API requests on behalf of your customer by including an <code>Authorization</code> header in the request.</p>
<p>Here is a Java code sample that uses an access token to call <a href="../../api#tag/Campaign/paths/~1campaignSchemas/get">GET /campaignSchemas</a>.</p>

<div class="accordion  mt-6 mb-4">
  <div>







<div id="call-e-fota-api-sample" class="accordion-item">
  <h4 class="body-3  mt-0 " id="panelsStayOpen-heading6-0">
    <button
        class="accordion-button accordion-header fw-bold text-grey  collapsed "
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#panelsStayOpen-collapse6-0"
        aria-expanded="false"
        aria-controls="panelsStayOpen-collapse6-0"
    >
      <div>Code sample
      </div>
    </button>
  </h4>
  <div
      id="panelsStayOpen-collapse6-0"
      class="accordion-collapse collapse "
      aria-labelledby="panelsStayOpen-heading6-0"
    >
      <div class="accordion-body text-grey"><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">private</span> HttpResponse<span style="color:#666">&lt;</span>String<span style="color:#666">&gt;</span> <span style="color:#00f">getCampaignSchemas</span><span style="color:#666">(</span>String accessToken<span style="color:#666">)</span> <span style="color:#008000;font-weight:bold">throws</span> URISyntaxException<span style="color:#666">,</span> IOException<span style="color:#666">,</span> InterruptedException <span style="color:#666">{</span>
</span></span><span style="display:flex;"><span>    String campaignSchemasUrl <span style="color:#666">=</span>  apiUri <span style="color:#666">+</span> <span style="color:#ba2121">&#34;campaignSchemas&#34;</span><span style="color:#666">;</span>
</span></span><span style="display:flex;"><span>    HttpClient client <span style="color:#666">=</span> HttpClient<span style="color:#666">.</span><span style="color:#7d9029">newHttpClient</span><span style="color:#666">();</span>
</span></span><span style="display:flex;"><span>    HttpRequest request <span style="color:#666">=</span> HttpRequest<span style="color:#666">.</span><span style="color:#7d9029">newBuilder</span><span style="color:#666">()</span>
</span></span><span style="display:flex;"><span>            <span style="color:#666">.</span><span style="color:#7d9029">uri</span><span style="color:#666">(</span><span style="color:#008000;font-weight:bold">new</span> URI<span style="color:#666">(</span>campaignSchemasUrl<span style="color:#666">))</span>
</span></span><span style="display:flex;"><span>            <span style="color:#666">.</span><span style="color:#7d9029">headers</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;Authorization&#34;</span><span style="color:#666">,</span> <span style="color:#ba2121">&#34;Bearer &#34;</span> <span style="color:#666">+</span> accessToken<span style="color:#666">)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#666">.</span><span style="color:#7d9029">GET</span><span style="color:#666">()</span>
</span></span><span style="display:flex;"><span>            <span style="color:#666">.</span><span style="color:#7d9029">build</span><span style="color:#666">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">return</span> client<span style="color:#666">.</span><span style="color:#7d9029">send</span><span style="color:#666">(</span>request<span style="color:#666">,</span> HttpResponse<span style="color:#666">.</span><span style="color:#7d9029">BodyHandlers</span><span style="color:#666">.</span><span style="color:#7d9029">ofString</span><span style="color:#666">());</span>
</span></span><span style="display:flex;"><span><span style="color:#666">}</span>
</span></span></code></pre></div></div>
    </div>
</div>
</div>
</div>

<h3 id="step-4-refresh-access-token">Step 4: Refresh access token</h3>
<p>To protect customer data, access tokens are only valid for a limited time. To avoid having to send your customers through the authorization process again, the <a href="../../../knox-cloud-authentication/knox-oauth-2-0-authentication/knox-oauth-2-0-authentication-api#tag/Authorization-server/operation/postToken">Knox OAuth 2.0 Authentication API</a> also provides a refresh token along with the access token in step 2.</p>
<p>As long as it&rsquo;s valid, you can use the refresh token obtained to request for another access token without needing an authorization code, which means your customers won&rsquo;t have to go through the authorization process in step 1 again. The refresh token expiration time can be configured between 60 minutes and 90 days, and you can set this value when you <a href="../../../knox-cloud-authentication/knox-oauth-2-0-authentication/register-new-app">register your app</a>.</p>
<p>Here is a Java code sample that requests for an access token using a refresh token:</p>

<div class="accordion  mt-6 mb-4">
  <div>







<div id="refresh-access-token-sample" class="accordion-item">
  <h4 class="body-3  mt-0 " id="panelsStayOpen-heading7-0">
    <button
        class="accordion-button accordion-header fw-bold text-grey  collapsed "
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#panelsStayOpen-collapse7-0"
        aria-expanded="false"
        aria-controls="panelsStayOpen-collapse7-0"
    >
      <div>Code sample
      </div>
    </button>
  </h4>
  <div
      id="panelsStayOpen-collapse7-0"
      class="accordion-collapse collapse "
      aria-labelledby="panelsStayOpen-heading7-0"
    >
      <div class="accordion-body text-grey"><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">private</span> HttpResponse<span style="color:#666">&lt;</span>String<span style="color:#666">&gt;</span> <span style="color:#00f">getTokenRefresh</span><span style="color:#666">(</span>
</span></span><span style="display:flex;"><span>        String refreshToken<span style="color:#666">)</span> <span style="color:#008000;font-weight:bold">throws</span> URISyntaxException<span style="color:#666">,</span> IOException<span style="color:#666">,</span> InterruptedException <span style="color:#666">{</span>
</span></span><span style="display:flex;"><span>    String tokenUrl <span style="color:#666">=</span> authUri <span style="color:#666">+</span> <span style="color:#ba2121">&#34;oauth2/token&#34;</span><span style="color:#666">;</span>
</span></span><span style="display:flex;"><span>    Map<span style="color:#666">&lt;</span>String<span style="color:#666">,</span> String<span style="color:#666">&gt;</span> parameters <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">new</span> HashMap<span style="color:#666">&lt;&gt;();</span>
</span></span><span style="display:flex;"><span>    parameters<span style="color:#666">.</span><span style="color:#7d9029">put</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;grant_type&#34;</span><span style="color:#666">,</span> <span style="color:#ba2121">&#34;refresh_token&#34;</span><span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    parameters<span style="color:#666">.</span><span style="color:#7d9029">put</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;client_id&#34;</span><span style="color:#666">,</span> clientId<span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    parameters<span style="color:#666">.</span><span style="color:#7d9029">put</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;client_secret&#34;</span><span style="color:#666">,</span> clientSecret<span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    parameters<span style="color:#666">.</span><span style="color:#7d9029">put</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;refresh_token&#34;</span><span style="color:#666">,</span> refreshToken<span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    String body <span style="color:#666">=</span> convertToUrlEncoded<span style="color:#666">(</span>parameters<span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    HttpClient client <span style="color:#666">=</span> HttpClient<span style="color:#666">.</span><span style="color:#7d9029">newHttpClient</span><span style="color:#666">();</span>
</span></span><span style="display:flex;"><span>    HttpRequest request <span style="color:#666">=</span> HttpRequest<span style="color:#666">.</span><span style="color:#7d9029">newBuilder</span><span style="color:#666">()</span>
</span></span><span style="display:flex;"><span>            <span style="color:#666">.</span><span style="color:#7d9029">uri</span><span style="color:#666">(</span><span style="color:#008000;font-weight:bold">new</span> URI<span style="color:#666">(</span>tokenUrl<span style="color:#666">))</span>
</span></span><span style="display:flex;"><span>            <span style="color:#666">.</span><span style="color:#7d9029">headers</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;Content-Type&#34;</span><span style="color:#666">,</span> <span style="color:#ba2121">&#34;application/x-www-form-urlencoded&#34;</span><span style="color:#666">)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#666">.</span><span style="color:#7d9029">POST</span><span style="color:#666">(</span>HttpRequest<span style="color:#666">.</span><span style="color:#7d9029">BodyPublishers</span><span style="color:#666">.</span><span style="color:#7d9029">ofString</span><span style="color:#666">(</span>body<span style="color:#666">))</span>
</span></span><span style="display:flex;"><span>            <span style="color:#666">.</span><span style="color:#7d9029">build</span><span style="color:#666">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">return</span> client<span style="color:#666">.</span><span style="color:#7d9029">send</span><span style="color:#666">(</span>request<span style="color:#666">,</span> HttpResponse<span style="color:#666">.</span><span style="color:#7d9029">BodyHandlers</span><span style="color:#666">.</span><span style="color:#7d9029">ofString</span><span style="color:#666">());</span>
</span></span><span style="display:flex;"><span><span style="color:#666">}</span>
</span></span></code></pre></div></div>
    </div>
</div>
</div>
</div>

<h4 id="automate-refresh-access-token">Automate refresh access token</h4>
<p>Here&rsquo;s a code sample which calls <a href="../../api#tag/Campaign/paths/~1campaignSchemas/get">GET /campaignSchemas</a>, and automatically requests for a new access token using the refresh token if the previous one expired.</p>

<div class="accordion  mt-6 mb-4">
  <div>







<div id="automatic-refresh-token-request" class="accordion-item">
  <h4 class="body-3  mt-0 " id="panelsStayOpen-heading8-0">
    <button
        class="accordion-button accordion-header fw-bold text-grey  collapsed "
        type="button"
        data-bs-toggle="collapse"
        data-bs-target="#panelsStayOpen-collapse8-0"
        aria-expanded="false"
        aria-controls="panelsStayOpen-collapse8-0"
    >
      <div>Code sample
      </div>
    </button>
  </h4>
  <div
      id="panelsStayOpen-collapse8-0"
      class="accordion-collapse collapse "
      aria-labelledby="panelsStayOpen-heading8-0"
    >
      <div class="accordion-body text-grey"><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">private</span> String <span style="color:#00f">getCampaignSchemas</span><span style="color:#666">()</span> <span style="color:#008000;font-weight:bold">throws</span> URISyntaxException<span style="color:#666">,</span> IOException<span style="color:#666">,</span> InterruptedException <span style="color:#666">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#408080;font-style:italic">//If our access token is expired we will get a new one.
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span>    tokenRefreshIfExpired<span style="color:#666">();</span>
</span></span><span style="display:flex;"><span>    var response <span style="color:#666">=</span> getCampaignSchemas<span style="color:#666">(</span>accessToken<span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">return</span> response<span style="color:#666">.</span><span style="color:#7d9029">body</span><span style="color:#666">();</span>
</span></span><span style="display:flex;"><span><span style="color:#666">}</span>
</span></span><span style="display:flex;"><span><span style="color:#008000;font-weight:bold">private</span> <span style="color:#b00040">void</span> <span style="color:#00f">tokenRefreshIfExpired</span><span style="color:#666">()</span> <span style="color:#008000;font-weight:bold">throws</span> URISyntaxException<span style="color:#666">,</span> IOException<span style="color:#666">,</span> InterruptedException <span style="color:#666">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#408080;font-style:italic">//Check if our access token is still valid.
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span>    <span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">(</span>expirationTime<span style="color:#666">.</span><span style="color:#7d9029">isAfter</span><span style="color:#666">(</span>Instant<span style="color:#666">.</span><span style="color:#7d9029">now</span><span style="color:#666">().</span><span style="color:#7d9029">plus</span><span style="color:#666">(</span><span style="color:#666">30L</span><span style="color:#666">,</span> ChronoUnit<span style="color:#666">.</span><span style="color:#7d9029">SECONDS</span><span style="color:#666">)))</span> <span style="color:#666">{</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#666">.</span><span style="color:#7d9029">out</span><span style="color:#666">.</span><span style="color:#7d9029">println</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;Access token is still valid&#34;</span><span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#008000;font-weight:bold">return</span><span style="color:#666">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#408080;font-style:italic">//If our token is expired, we need to send request for token refresh.
</span></span></span><span style="display:flex;"><span><span style="color:#408080;font-style:italic"></span>    var response <span style="color:#666">=</span> getTokenRefresh<span style="color:#666">(</span>refreshToken<span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#008000;font-weight:bold">if</span> <span style="color:#666">(</span>response<span style="color:#666">.</span><span style="color:#7d9029">statusCode</span><span style="color:#666">()</span> <span style="color:#666">!=</span> <span style="color:#666">200</span><span style="color:#666">)</span> <span style="color:#666">{</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#666">.</span><span style="color:#7d9029">out</span><span style="color:#666">.</span><span style="color:#7d9029">println</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;Something went wrong. Status code: &#34;</span> <span style="color:#666">+</span> response<span style="color:#666">.</span><span style="color:#7d9029">statusCode</span><span style="color:#666">());</span>
</span></span><span style="display:flex;"><span>    <span style="color:#666">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Instant currentTime <span style="color:#666">=</span> Instant<span style="color:#666">.</span><span style="color:#7d9029">now</span><span style="color:#666">();</span>
</span></span><span style="display:flex;"><span>    JSONObject json <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">new</span> JSONObject<span style="color:#666">(</span>response<span style="color:#666">.</span><span style="color:#7d9029">body</span><span style="color:#666">());</span>
</span></span><span style="display:flex;"><span>    accessToken <span style="color:#666">=</span> json<span style="color:#666">.</span><span style="color:#7d9029">getString</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;access_token&#34;</span><span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    refreshToken <span style="color:#666">=</span> json<span style="color:#666">.</span><span style="color:#7d9029">getString</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;refresh_token&#34;</span><span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    expiresIn <span style="color:#666">=</span> json<span style="color:#666">.</span><span style="color:#7d9029">getInt</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;expires_in&#34;</span><span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    expirationTime <span style="color:#666">=</span> currentTime<span style="color:#666">.</span><span style="color:#7d9029">plusSeconds</span><span style="color:#666">(</span>expiresIn<span style="color:#666">);</span>
</span></span><span style="display:flex;"><span>    System<span style="color:#666">.</span><span style="color:#7d9029">out</span><span style="color:#666">.</span><span style="color:#7d9029">println</span><span style="color:#666">(</span><span style="color:#ba2121">&#34;Access token was refreshed.&#34;</span><span style="color:#666">);</span>
</span></span><span style="display:flex;"><span><span style="color:#666">}</span>
</span></span></code></pre></div></div>
    </div>
</div>
</div>
</div>

<p>Add your own custom error handling, logging, and exception propagation based on your application&rsquo;s specific requirements.</p>
<h2 id="get-started-with-knox-e-fota">Get started with Knox E-FOTA</h2>
<p>Once you complete Knox OAuth 2.0 Authentication, you can begin calling the Knox E-FOTA API.</p>
<a href="../best-practices/knox-efota-workflow"  class="btn d-inline-block button-subtle">Get started</a>

            
          </div>
          <div class="l-toh">
            
  <h2 class="body-4 fw-bold mt-0">On this page</h2>
<aside class="table-of-headings">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#register-an-app">Register an app</a></li>
    <li><a href="#3-legged-knox-oauth-20-authentication">3-legged Knox OAuth 2.0 Authentication</a>
      <ul>
        <li><a href="#step-1-request-an-authorization-code">Step 1: Request an authorization code</a></li>
        <li><a href="#step-2-exchange-authorization-code-for-an-access-token">Step 2: Exchange authorization code for an access token</a></li>
        <li><a href="#step-3-call-the-knox-e-fota-api">Step 3: Call the Knox E-FOTA API</a></li>
        <li><a href="#step-4-refresh-access-token">Step 4: Refresh access token</a></li>
      </ul>
    </li>
    <li><a href="#get-started-with-knox-e-fota">Get started with Knox E-FOTA</a></li>
  </ul>
</nav>
</aside>

          </div>
        </div> 
      </div><div>
  <div id="feedbackQuestion" class="py-4 border-top text-center">
    <p class="body-4 mb-2">Is this page helpful?</p>
    <button id="feedbackYes" class="button-icon me-4">
      <span class="button-thumbs-up pe-4"></span> YES
    </button>
    <button id="feedbackNo" class="button-icon">
      <span class="button-thumbs-down pe-4"></span> No
    </button>
  </div>
</div>

<div id="feedbackThanks" class="mt-6 border-top text-center" style="display: none">
  <p class="body-4 pt-4">Thank you for your feedback!</p>
</div>



    
  </main>
  
    <footer class="border-top">
  
  <div class="container footer">
    <div class="row g-0 footer-top-section">
      
      <div class="col-sm-12 col-md-6 col-lg-3 footer-vertical-section">
        <div class="d-flex justify-content-between align-items-center">
          <a class="footer-section-title" data-bs-toggle="collapse" href="#item0" role="button" aria-expanded="false" aria-controls="item0"> 
            <h6 class="body-3 fw-bold text-uppercase text-black pt-4">Knox Developer documentation</h6>
          </a>
          <a class="btn-toggle d-inline-flex d-lg-none rounded border-0 fw-light" data-bs-toggle="collapse" data-bs-target="#item0" aria-expanded="false"></a>
        </div>
        <div class="d-lg-block collapse" id="item0">
          <ul class="nav flex-column">
            
            <li>
              <a
                href="../../../fundamentals"
                class="body-5 d-flex align-items-center text-black fw-light pe-auto text-decoration-none"
                >Fundamentals</a
              >
            </li>
            
            <li>
              <a
                href="../../../knox-sdk"
                class="body-5 d-flex align-items-center text-black fw-light pe-auto text-decoration-none"
                >Knox SDK</a
              >
            </li>
            
            <li>
              <a
                href="../../../knox-pos-sdk"
                class="body-5 d-flex align-items-center text-black fw-light pe-auto text-decoration-none"
                >Knox POS SDK</a
              >
            </li>
            
            <li>
              <a
                href="../../../knox-capture-sdk"
                class="body-5 d-flex align-items-center text-black fw-light pe-auto text-decoration-none"
                >Knox Capture SDK</a
              >
            </li>
            
            <li>
              <a
                href="../../../knox-tizen-sdk"
                class="body-5 d-flex align-items-center text-black fw-light pe-auto text-decoration-none"
                >Knox Tizen SDK</a
              >
            </li>
            
            <li>
              <a
                href="../../../knox-cloud-authentication"
                class="body-5 d-flex align-items-center text-black fw-light pe-auto text-decoration-none"
                >Knox Cloud Authentication</a
              >
            </li>
            
            <li>
              <a
                href="../../../knox-webhook-notification"
                class="body-5 d-flex align-items-center text-black fw-light pe-auto text-decoration-none"
                >Knox Webhook Notification</a
              >
            </li>
            
            <li>
              <a
                href="../../../knox-deployment-program"
                class="body-5 d-flex align-items-center text-black fw-light pe-auto text-decoration-none"
                >Knox Deployment Program</a
              >
            </li>
            
            <li>
              <a
                href="../../../knox-msp-portal"
                class="body-5 d-flex align-items-center text-black fw-light pe-auto text-decoration-none"
                >Knox MSP Portal</a
              >
            </li>
            
            <li>
              <a
                href="../../../knox-mobile-enrollment"
                class="body-5 d-flex align-items-center text-black fw-light pe-auto text-decoration-none"
                >Knox Mobile Enrollment</a
              >
            </li>
            
            <li>
              <a
                href="../../../knox-configure"
                class="body-5 d-flex align-items-center text-black fw-light pe-auto text-decoration-none"
                >Knox Configure</a
              >
            </li>
            
            <li>
              <a
                href="../../../knox-manage"
                class="body-5 d-flex align-items-center text-black fw-light pe-auto text-decoration-none"
                >Knox Manage</a
              >
            </li>
            
            <li>
              <a
                href="../../../knox-attestation"
                class="body-5 d-flex align-items-center text-black fw-light pe-auto text-decoration-none"
                >Knox Attestation</a
              >
            </li>
            
            <li>
              <a
                href="../../../knox-guard"
                class="body-5 d-flex align-items-center text-black fw-light pe-auto text-decoration-none"
                >Knox Guard</a
              >
            </li>
            
            <li>
              <a
                href="../../../knox-asset-intelligence"
                class="body-5 d-flex align-items-center text-black fw-light pe-auto text-decoration-none"
                >Knox Asset Intelligence</a
              >
            </li>
            
            <li>
              <a
                href="../../../managed-configurations"
                class="body-5 d-flex align-items-center text-black fw-light pe-auto text-decoration-none"
                >Managed configurations</a
              >
            </li>
            
          </ul>
        </div>
      </div>
      
      <div class="col-sm-12 col-md-6 col-lg-3 footer-vertical-section">
        <div class="d-flex justify-content-between align-items-center">
          <a class="footer-section-title" data-bs-toggle="collapse" href="#item1" role="button" aria-expanded="false" aria-controls="item1"> 
            <h6 class="body-3 fw-bold text-uppercase text-black pt-4">Support</h6>
          </a>
          <a class="btn-toggle d-inline-flex d-lg-none rounded border-0 fw-light" data-bs-toggle="collapse" data-bs-target="#item1" aria-expanded="false"></a>
        </div>
        <div class="d-lg-block collapse" id="item1">
          <ul class="nav flex-column">
            
            <li>
              <a
                href="https://developer.samsungknox.com/dashboard/support"
                class="body-5 d-flex align-items-center text-black fw-light pe-auto text-decoration-none"
                >Submit a support ticket</a
              >
            </li>
            
          </ul>
        </div>
      </div>
      
      <div class="col-sm-12 col-md-6 col-lg-3 footer-vertical-section">
        <div class="d-flex justify-content-between align-items-center">
          <a class="footer-section-title" data-bs-toggle="collapse" href="#item2" role="button" aria-expanded="false" aria-controls="item2"> 
            <h6 class="body-3 fw-bold text-uppercase text-black pt-4">Samsung</h6>
          </a>
          <a class="btn-toggle d-inline-flex d-lg-none rounded border-0 fw-light" data-bs-toggle="collapse" data-bs-target="#item2" aria-expanded="false"></a>
        </div>
        <div class="d-lg-block collapse" id="item2">
          <ul class="nav flex-column">
            
            <li>
              <a
                href="https://www.samsungknox.com/en"
                class="body-5 d-flex align-items-center text-black fw-light pe-auto text-decoration-none"
                >Samsung Knox</a
              >
            </li>
            
            <li>
              <a
                href="https://partner.samsungknox.com/"
                class="body-5 d-flex align-items-center text-black fw-light pe-auto text-decoration-none"
                >Samsung Knox Partner Program</a
              >
            </li>
            
            <li>
              <a
                href="https://developer.samsung.com/"
                class="body-5 d-flex align-items-center text-black fw-light pe-auto text-decoration-none"
                >Samsung Knox Developer</a
              >
            </li>
            
          </ul>
        </div>
      </div>
      
    </div>
  </div>
  <div class="container py-4 border-bottom border-top">
    <p class="m-0"><small>Copyright © 1995-<script>document.write(new Date().getFullYear());</script><noscript>2023</noscript> SAMSUNG All Rights Reserved.</small></p>
  </div>
  <div class="container">
    <div class="footer-bottom-section-row">
      <div class="d-flex py-4 justify-content-between">
        <div class="d-flex align-items-center">
          
          <p class="m-0 footer-bottom-section-item">
            <a class="body-6 text-uppercase text-black" href="https://www2.samsungknox.com/en/privacy-policy-us">Privacy policy</a>
          </p>
          
          <p class="m-0 footer-bottom-section-item">
            <a class="body-6 text-uppercase text-black" href="https://www.samsungknox.com/en/legal">Legal</a>
          </p>
          
        </div>
      </div>
    </div>
  </div>
</footer>

  
</body>

</html>
